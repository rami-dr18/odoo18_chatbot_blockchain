<odoo>
    <!-- Form View for Reorder Contract -->
    <record id="view_stock_reorder_contract_form" model="ir.ui.view">
        <field name="name">stock.reorder.contract.form</field>
        <field name="model">stock.reorder.contract</field>
        <field name="arch" type="xml">
            <form string="Smart Contract R√©approvisionnement">
                <header>
                    <button name="action_validate_contract" type="object" string="‚úÖ Valider Blockchain" 
                            invisible="state != 'triggered'" class="oe_highlight"/>
                    <button name="action_create_order" type="object" string="üì¶ Cr√©er Commande" 
                            invisible="state != 'validated'" class="oe_highlight"/>
                    <button name="action_receive_stock" type="object" string="‚úîÔ∏è Marquer Re√ßu" 
                            invisible="state != 'ordered'" class="oe_highlight"/>
                    <button name="action_cancel" type="object" string="‚ùå Annuler" 
                            invisible="state in ('received', 'cancelled')"/>
                    <button name="verify_blockchain_integrity" type="object" string="üîç V√©rifier Blockchain" 
                            invisible="state == 'draft'"/>
                    <field name="state" widget="statusbar" statusbar_visible="triggered,validated,ordered,received"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                    </div>
                    
                    <div invisible="state != 'draft'" style="padding: 10px; background: #fff3cd; border-radius: 8px; margin-bottom: 15px;">
                        <p style="margin: 0; color: #856404;">
                            ‚ÑπÔ∏è <strong>Cr√©ation manuelle:</strong> S√©lectionnez un produit ci-dessous. Normalement, les contrats sont cr√©√©s automatiquement quand le stock atteint le seuil configur√© dans le produit.
                        </p>
                    </div>
                    
                    <group>
                        <group string="üìã Informations Contrat">
                            <field name="product_id" required="1" readonly="state != 'draft'"/>
                            <field name="trigger_date" readonly="state != 'draft'"/>
                            <field name="trigger_quantity" readonly="state != 'draft'"/>
                            <field name="threshold" readonly="state != 'draft'"/>
                        </group>
                        <group string="üì¶ Commande">
                            <field name="order_quantity" required="1" readonly="state != 'draft'"/>
                            <field name="supplier_id" readonly="state != 'draft'"/>
                            <field name="expected_delivery_date"/>
                            <field name="entry_id" readonly="1" invisible="not entry_id"/>
                        </group>
                    </group>
                    
                    <notebook>
                        <page string="üîó Blockchain">
                            <group>
                                <group>
                                    <field name="contract_hash" readonly="1"/>
                                    <field name="previous_hash" readonly="1"/>
                                </group>
                                <group>
                                    <field name="validation_hash" readonly="1"/>
                                    <field name="blockchain_timestamp" readonly="1"/>
                                </group>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- List View -->
    <record id="view_stock_reorder_contract_list" model="ir.ui.view">
        <field name="name">stock.reorder.contract.list</field>
        <field name="model">stock.reorder.contract</field>
        <field name="arch" type="xml">
            <list string="Contrats de R√©approvisionnement" decoration-success="state == 'received'" 
                  decoration-info="state in ('triggered', 'validated')" decoration-warning="state == 'ordered'">
                <field name="name"/>
                <field name="product_id"/>
                <field name="trigger_date"/>
                <field name="order_quantity"/>
                <field name="supplier_id"/>
                <field name="expected_delivery_date"/>
                <field name="state" widget="badge" decoration-success="state == 'received'" 
                       decoration-info="state in ('triggered', 'validated')" decoration-warning="state == 'ordered'"/>
            </list>
        </field>
    </record>

    <!-- Kanban View -->
    <record id="view_stock_reorder_contract_kanban" model="ir.ui.view">
        <field name="name">stock.reorder.contract.kanban</field>
        <field name="model">stock.reorder.contract</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <field name="name"/>
                <field name="product_id"/>
                <field name="state"/>
                <field name="order_quantity"/>
                <field name="supplier_id"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_global_click" style="padding: 15px; border-left: 5px solid #3498db;">
                            <div class="oe_kanban_content">
                                <strong><field name="name"/></strong><br/>
                                <strong>Produit:</strong> <field name="product_id"/><br/>
                                <strong>Quantit√©:</strong> <field name="order_quantity"/><br/>
                                <strong>Fournisseur:</strong> <field name="supplier_id"/><br/>
                                <field name="state" widget="badge"/>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Action -->
    <record id="action_stock_reorder_contract" model="ir.actions.act_window">
        <field name="name">üîÑ Smart Contracts R√©approvisionnement</field>
        <field name="res_model">stock.reorder.contract</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Aucun contrat de r√©approvisionnement
            </p>
            <p>
                <strong>Comment √ßa marche?</strong><br/>
                1. Allez dans <strong>Produits</strong><br/>
                2. Ouvrez un produit et allez dans l'onglet <strong>Smart Contract Auto-Reorder</strong><br/>
                3. Activez le r√©approvisionnement automatique<br/>
                4. Configurez le seuil, la quantit√© et le fournisseur<br/>
                5. Quand le stock atteint le seuil, un contrat est cr√©√© automatiquement!<br/><br/>
                Vous pouvez aussi cr√©er un contrat manuellement en cliquant sur "Nouveau".
            </p>
        </field>
    </record>
</odoo>
